<script>
  function next() {
    w.location.replace('http://www.google.com/csi');
  }

function f() {
  // Open popup FIRST
  let w = window.open("http://amazon.com", "new", "width=500,height=500");
  
  // Check if popup was blocked
  if (!w || w.closed || typeof w.closed == 'undefined') {
    alert("Popup was blocked! Please allow popups for this site.");
    return;
  }
  
  // THEN ask for confirmation
  if (confirm("Do you want to continue with the popup?")) {
    
    // Write content to popup (only works if same origin)
    try {
      w.document.write(`<h1>This is groot</h1>`);
    } catch (e) {
      console.log("Cannot write to popup - different origin");
    }
    
    // Modified interval line
    i = setInterval("try { x = w.location.href; } catch(e) { clearInterval(i); next(); }", 1);
    
  } else {
    // User canceled - close the popup
    w.close();
    alert("Popup canceled.");
  }
}



</script>

<a href="#" onclick="f()">Login Google</a>
